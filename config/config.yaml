# Kraken Momentum Trader Configuration
# WARNING: Start with paper_trading: true and validate strategy before using real capital

trading:
  pairs: ["BTC/USD", "ETH/USD", "XRP/USD", "SOL/USD", "DOGE/USD", "ADA/USD", "AVAX/USD"]
  check_interval_seconds: 60
  paper_trading: true  # CRITICAL: Keep true until strategy validated over 2+ weeks
  paper_trading_capital: 10000.0  # Starting capital for paper trading simulation

strategy:
  name: "momentum"
  momentum_threshold: 0.01  # Reduced from 0.02 for sideways markets
  min_expected_gain: 0.008  # Reduced from 0.015 for more frequent trades

  # RSI Configuration - widened bands for more signals
  rsi_period: 14
  rsi_oversold: 38  # Raised from 30 - triggers buy signals earlier
  rsi_overbought: 62  # Lowered from 70 - triggers sell signals earlier

  # EMA Configuration
  ema_short_period: 12
  ema_long_period: 26

  # Volume Configuration
  volume_sma_period: 20
  volume_threshold: 1.25  # Reduced from 1.5 - less strict volume requirement

risk:
  # Position Limits
  max_position_size_usd: 5000
  max_position_percent: 40.0  # Max 40% of capital per initial trade
  max_total_exposure_percent: 100.0  # Max 100% total exposure (no margin)

  # Trailing Stop Configuration - tightened for sideways markets
  use_trailing_stop: true
  trailing_stop_percent: 3.5  # Reduced from 5.0 - tighter stop to lock in gains
  trailing_stop_activation_percent: 2.5  # Reduced from 5.0 - activate stop sooner
  initial_stop_loss_percent: 0.0  # No initial stop loss (0 = disabled)

  # Martingale Configuration
  martingale:
    enabled: true
    max_entries: 4  # Initial + 3 add-ons
    size_multiplier: 1.25  # Each add-on is 1.25x previous
    add_on_drop_percent: 5.0  # Add when price drops 5% from avg entry
    require_rsi_oversold: true  # Must have RSI < 30 to add
    require_ema_trend: false  # Don't require EMA confirmation for adds

  # Circuit Breaker (adjusted for Martingale)
  circuit_breaker_consecutive_losses: 5  # Increased from 3
  circuit_breaker_cooldown_hours: 2  # Reduced from 4

exchange:
  name: "kraken"
  api_version: "0"
  rate_limit_calls_per_minute: 15
  retry_attempts: 3
  retry_delay_seconds: 2

persistence:
  type: "sqlite"  # "sqlite" recommended, "file" for legacy JSON
  db_path: "data/trading.db"

logging:
  level: "INFO"
  format: "json"  # "json" for production, "text" for development
  include_timestamps: true

notifications:
  discord:
    enabled: true
    webhook_url: ""  # Set via DISCORD_WEBHOOK_URL environment variable
  daily_summary:
    enabled: true
    hour: 17  # 5 PM
    minute: 0
    timezone: "America/New_York"

# Machine Learning Signal Enhancement
ml:
  enabled: true  # Enable ML-based signal filtering
  confidence_threshold: 0.6  # Min ML confidence to approve signals (0.5-1.0)
  model_dir: "data/ml/models"

  # Auto-retraining triggers
  retrain_after_trades: 50  # Retrain after N completed trades
  min_samples_for_retrain: 100  # Minimum samples needed for training
  performance_threshold: 0.4  # Retrain if recent win rate drops below this
  check_interval_seconds: 3600  # How often to check retrain triggers
