# Scalping Strategy Configuration
# Re-optimized 2026-02-28 using 90 days of 4h Kraken data (Nov 2025 - Feb 2026)
# Scoring: composite of returns (40%), Sharpe (30%), profit factor (20%), minus drawdown & trade penalty
#
# Optimization Results (90 days, 4h candles, 100 trials/pair):
#   BTC/USD:  +0.68% return, 60.0% win rate, PF 1.22, 15 trades  (VIABLE)
#   LINK/USD: +2.45% return, 80.0% win rate, PF 2.36, 10 trades  (VIABLE)
#   AVAX/USD: +3.33% return, 60.0% win rate, PF 1.89, 10 trades  (VIABLE)
#   XRP/USD:  +1.01% return, 50.0% win rate, PF 1.27, 10 trades  (MARGINAL)
#   ETH/USD:  +2.45% return, 100% win rate,  2 trades only        (LOW DATA)
#   SOL/USD:  -1.82% return, 45.5% win rate, PF 0.77, 22 trades  (NOT VIABLE)
#   DOGE/USD: -0.93% return, 25.0% win rate, PF 0.92, 28 trades  (NOT VIABLE)
#   ADA/USD:  -0.94% return, 26.1% win rate, PF 0.91, 23 trades  (NOT VIABLE)
#
# Strategy: Multi-indicator confirmation with VWAP, Bollinger Bands, RSI, Volume
# Entry: Buy when 2-3 signals confirm oversold conditions
# Exit: Take profit at optimized %, stop loss at optimized %, or indicator reversal

strategy:
  name: "scalping"

  # Default parameters (fallback when per-pair not specified)
  # Conservative defaults: tighter TP, wider SL, higher confirmations
  take_profit_percent: 3.0    # Reduced from 5.0 — smaller, more achievable targets
  stop_loss_percent: 2.0      # Wider relative to TP — more breathing room
  candle_interval: 240        # 4-hour candles — less noise, better signal quality
  min_confirmations: 3        # High quality trades only

# Indicator settings (defaults — overridden by per-pair params)
indicators:
  rsi:
    period: 10
    oversold: 30.0
    overbought: 65.0

  bollinger:
    period: 25
    std_dev: 2.0
    squeeze_threshold: 3.0

  vwap:
    threshold_percent: 0.5

  volume:
    spike_threshold: 1.75

# Trading pairs — ordered by optimization confidence
# Viable pairs first, marginal/unproven next, weak pairs last
pairs:
  - BTC/USD    # VIABLE:  +0.68%, 60% WR, 15 trades
  - LINK/USD   # VIABLE:  +2.45%, 80% WR, 10 trades
  - AVAX/USD   # VIABLE:  +3.33%, 60% WR, 10 trades
  - XRP/USD    # MARGINAL: +1.01%, 50% WR, 10 trades
  - ETH/USD    # LOW DATA: +2.45%, 2 trades only — adaptive manager will evaluate
  - SOL/USD    # WEAK: -1.82%, 45.5% WR — adaptive manager should disable
  - ADA/USD    # WEAK: -0.94%, 26.1% WR — adaptive manager should disable
  - DOGE/USD   # WEAK: -0.93%, 25% WR — adaptive manager should disable

# Per-pair optimized parameters (from run_scalping_optimizer.py, 2026-02-28)
# Each pair was independently optimized with 100 Bayesian trials
pair_parameters:
  BTC/USD:
    take_profit_percent: 2.0
    stop_loss_percent: 1.0
    rsi_period: 8
    rsi_oversold: 20
    rsi_overbought: 60
    bb_period: 25
    bb_std_dev: 2.0
    vwap_threshold_percent: 0.3
    volume_spike_threshold: 1.5
    min_confirmations: 2

  ETH/USD:
    take_profit_percent: 3.0
    stop_loss_percent: 1.0
    rsi_period: 13
    rsi_oversold: 40
    rsi_overbought: 75
    bb_period: 25
    bb_std_dev: 1.5
    vwap_threshold_percent: 0.2
    volume_spike_threshold: 2.25
    min_confirmations: 3

  SOL/USD:
    take_profit_percent: 3.0
    stop_loss_percent: 1.0
    rsi_period: 6
    rsi_oversold: 40
    rsi_overbought: 60
    bb_period: 15
    bb_std_dev: 2.25
    vwap_threshold_percent: 0.1
    volume_spike_threshold: 1.25
    min_confirmations: 2

  XRP/USD:
    take_profit_percent: 5.0
    stop_loss_percent: 2.0
    rsi_period: 5
    rsi_oversold: 30
    rsi_overbought: 65
    bb_period: 20
    bb_std_dev: 1.75
    vwap_threshold_percent: 0.3
    volume_spike_threshold: 2.25
    min_confirmations: 2

  DOGE/USD:
    take_profit_percent: 6.5
    stop_loss_percent: 1.5
    rsi_period: 5
    rsi_oversold: 25
    rsi_overbought: 65
    bb_period: 30
    bb_std_dev: 1.75
    vwap_threshold_percent: 0.9
    volume_spike_threshold: 2.25
    min_confirmations: 1

  ADA/USD:
    take_profit_percent: 8.0
    stop_loss_percent: 1.5
    rsi_period: 6
    rsi_oversold: 30
    rsi_overbought: 65
    bb_period: 30
    bb_std_dev: 2.5
    vwap_threshold_percent: 0.5
    volume_spike_threshold: 2.5
    min_confirmations: 1

  LINK/USD:
    take_profit_percent: 8.0
    stop_loss_percent: 1.0
    rsi_period: 12
    rsi_oversold: 35
    rsi_overbought: 60
    bb_period: 30
    bb_std_dev: 1.75
    vwap_threshold_percent: 0.9
    volume_spike_threshold: 1.0
    min_confirmations: 2

  AVAX/USD:
    take_profit_percent: 5.5
    stop_loss_percent: 2.5
    rsi_period: 8
    rsi_oversold: 20
    rsi_overbought: 75
    bb_period: 30
    bb_std_dev: 1.5
    vwap_threshold_percent: 0.2
    volume_spike_threshold: 1.5
    min_confirmations: 2

# Adaptive pair management — tighter thresholds for faster disabling
adaptive:
  enabled: true
  min_win_rate: 0.35           # Disable pair if win rate < 35%
  min_profit_factor: 0.85      # Disable pair if PF < 0.85
  max_consecutive_losses: 3    # Disable after 3 consecutive losses (was 4)
  cooldown_hours: 2.0
  reenable_win_rate: 0.50      # Re-enable if simulated WR > 50%

# Position sizing
# initial_capital: auto-fetched from Kraken account on first start.
# Set a value here as fallback if API keys are unavailable.
position:
  initial_capital: 10000.0      # Fallback only; real balance fetched from Kraken
  size_percent: 20.0
  confidence_scaling: true
  min_scale: 0.5
  max_scale: 1.5

# Fees - USING MAKER ORDERS
fees:
  maker_percent: 0.16         # Kraken maker fee (limit orders)
  taker_percent: 0.26         # Kraken taker fee (market orders)

# Order execution - MAKER ORDERS for lower fees
execution:
  use_maker_orders: true      # Use limit orders for 0.16% vs 0.26%
  maker_price_offset: 0.0     # Place at bid/ask for fast fills
  order_timeout_seconds: 60   # Cancel unfilled orders after 60s

# Circuit breaker - drawdown-based (per-pair + global)
circuit_breaker:
  global_max_drawdown_pct: 5.0  # Halt ALL trading if account down 5% from peak
  cooldown_hours: 4             # Wait 4 hours before resuming
  pair_max_drawdown_pct: 2.0    # Pause single pair if down 2% of capital (was 3%)
  pair_cooldown_hours: 2.0      # Per-pair cooldown
  consecutive_loss_limit: 4     # Secondary: pause after 4 consecutive losses (was 5)

# Regime detector - auto-classifies bull/bear/sideways
# Adjusts TP/SL, position size, confirmations, and EMA filter per regime
regime_detector:
  fast_sma_period: 50           # For slope calculation
  slow_sma_period: 200          # For trend confirmation
  bull_slope_threshold: 0.05    # SMA rising > 0.05%/period = bull
  bear_slope_threshold: -0.05   # SMA falling < -0.05%/period = bear

# EMA trend filter - blocks entries during strong downtrends
# (Regime detector may override this: disabled in sideways, enabled in bear)
ema_filter:
  enabled: true
  bearish_threshold: -0.5       # Block if EMA trend strength < -0.5%

# Trading loop settings
trading:
  check_interval_seconds: 120   # Check every 2 min (was 60) — 4h candles don't need faster
